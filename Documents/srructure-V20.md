## PZPK文件结构描述

## Version 20

#### 整体结构
+ 文件头 - 固定 148 Bytes
+ 内容区 - (n) Bytes
+ 信息区 - (n) Bytes
+ 索引区 - (n) Bytes

#### 文件头
+ 04 - [int32] 文件版本号
+ 04 - [int32] 文件类型 `枚举PZType`
+ 32 - [bytes] 标识Hash `对PZType对应文本Sha256`
+ 16 - [bytes] 密码校验IV
+ 48 - [bytes] 密码校验 `使用密码和IV加密标识Hash`
+ 08 - [int64] 文件创建时间戳
+ 08 - [int64] 文件总大小
+ 04 - [int32] 文件分块大小
+ 08 - [int64] 信息区起始位置
+ 04 - [int32] 信息区数据长度
+ 08 - [int64] 索引区起始位置
+ 04 - [int32] 索引区数据长度

#### 内容区
> 内容区每一个文件都按文件头信息中的（分块大小 + 16）分块
> 每一个分块前16Bytes为IV向量，该块使用此IV向量解密
> 末尾分块不足一个分块大小时，按实际大小不填充

#### 信息区
> 使用文件头的信息区起始位置读取信息区数据长度
+ 16 - [bytes] 信息区IV向量
> 解密剩余部分
+ 04 - [int32] 包体名文本长度 = a
+ a  - [bytes] 包体名文本 `UTF8`
+ 04 - [int32] 描述文本长度 = b
+ b  - [bytes] 描述文本 `UTF8`
+ 04 - [int32] 标签文本长度 = c
+ c  - [bytes] 标签文本 `UTF8`

#### 索引区
> 使用文件头的索引区起始位置读取索引区数据长度
+ 16 - [bytes] 索引区IV向量
> 解密剩余部分
+ 04 [int32] 文件夹区内容长度 = x
+ 04 [int32] 文件区内容长度 = y
+ x [bytes] 文件夹区内容
+ y [bytes] 文件区内容

#### 索引区 - 文件夹区
> 按顺序读取
+ 04 [int32] 当前文件夹内容长度 = x
+ 04 [int32] 文件夹ID
+ 04 [int32] 父文件夹ID
+ (x - 12) [bytes] 文件夹名 `UTF8`

#### 索引区 - 文件区
> 按顺序读取
+ 04 [int32] 当前文件内容长度 = x
+ 04 [int32] 文件ID
+ 04 [int32] 父文件夹ID
+ 08 [int64] 文件数据在包文件内的偏移量(从0开始计算)
+ 08 [int64] 文件大小
+ 08 [int64] 源文件大小
+ (x - 36) [bytes] 文件名 `UTF8`

